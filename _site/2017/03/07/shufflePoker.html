<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>洗牌算法-扑克牌原来这么玩！ | Dailc的个人主页</title>
    <meta name="author" content="dailc" />
    <meta name="renderer" content="webkit">
    <meta name="description" content="Everything about dailc" />
    <meta name="baidu-site-verification" content="cVrw8PsZv7" />
    <meta name="keywords" content="dailc,戴荔春,戴荔春的博客,dailc的博客" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  	<link href="/asserts/css/default.css" rel="stylesheet" type="text/css" media="all">
	<script type="text/javascript" src="/asserts/js/app.js" ></script> 
</head>
<body>
	<!--头部 -->
	<header class="header">
		<div class="header-container">
			<section class="site-logo">
				<a  href="/">撒网要见鱼</a>
			</section>
			<button class="collapsed " type="button" >
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		    </button>
		    <div class="menu-container">
				<nav class="site-nav">
					<ul>
						<li>
							<a  href="/blog/archiveAll.html">随笔</a>
						</li>
						<li>
							<a  href="/blog/archive.html">博客</a>
						</li>
						<li>
							<a  href="/blog/categories.html">分类</a>
						</li>
						<li>
							<a  href="/blog/tags.html">标签</a>
						</li>
						<li>
							<a  href="/demo/demo.html">Demo</a>
						</li>
						<li>
							<a  href="/favour/music.html">音乐</a>
						</li>
						<li>
							<a  href="/favour/book.html">Book</a>
						</li>
						<li>
							<a  href="/about/timeline.html">时间轴</a>
						</li>
						<li>
							<a  href="/others/collection.html">收藏</a>
						</li>
						<li>
							<a  href="/about/about.html">关于</a>
						</li>
					</ul>
				</nav>
				<div class="site-search">
					<input type="text" />
				</div>
			</div>
		</div>
	</header>
	<link href="/asserts/css/blog_article_post.css" rel="stylesheet" type="text/css" media="all">
<link href="/asserts/css/blog_personCard_style.css" rel="stylesheet" type="text/css" media="all">
<link href="/asserts/css/imageBubble.css" rel="stylesheet" type="text/css" media="all">
	
	<div class="wrap">
		<div class="container">
			<!-- 左侧，内容，多说评论等-->
			<div class="col-md-9">
				<!-- 内容-->
				<div class="markdown-body">
					<!--标题区域 -->
					<div class="title-container">
					<h1 class="page-title"><a  title="洗牌算法-扑克牌原来这么玩！">洗牌算法-扑克牌原来这么玩！</a> </h1>
						<!-- metainfo-->
						<section class="meta clearfix">
<span class="time">
<time datetime="2017-03-07">2017-03-07</time>
</span>

| 
<span class="categories">
	分类
	    
	    <a href="/blog/categories.html#blog" title="blog">blog</a>&nbsp;
	    
</span>


| 
<span class="tags">
	标签
		
		<a href="/blog/tags.html#算法" title="算法">算法</a>&nbsp;
		
</span>

| 
<span class="views">
	浏览
	<a id="busuanzi_value_page_pv"></a>&nbsp;
</span>
</section>
						<section class="right-tips">
							<span >
								算法
							</span>
						</section>
					</div>
					<!-- 特别推荐-->
					
					<!-- 内容区域-->
					<div class="content-container">
						 <h2 id="前言">前言</h2>
<p>在逛<code class="highlighter-rouge">segmentfault</code>论坛时，遇到了这样一个提问: <strong>如何实现扑克牌的随机发牌算法？</strong>
然后花了点时间解答，顺便记录于本文之中。</p>

<p>原题链接: <a href="https://segmentfault.com/q/1010000008581427/a-1020000008584021">https://segmentfault.com/q/1010000008581427/a-1020000008584021</a></p>

<h2 id="思路与大纲">思路与大纲</h2>
<p>遇到这种需求，首先进行需求分析如下:</p>

<ul>
  <li>猜测是题主是在做一个扑克牌游戏</li>
  <li>需要实现随机发牌功能，可能是发<code class="highlighter-rouge">1,2,...,N(N&lt;=54)</code>张</li>
</ul>

<p>因此，可以得出如下结论: <strong>这是一个典型的洗牌算法问题</strong>，只要解决了扑克牌随机洗牌，自然发出的牌顺序是打乱的。</p>

<p>同时，为了后续可能的需求变更(比如变为多幅牌发牌-<code class="highlighter-rouge">升级</code>游戏就是两副牌的)，需要保证代码的通用性与可拓展性。</p>

<h2 id="代码实现js实现">代码实现(JS实现)</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>// 洗牌算法，传入一个数组，随机乱序排列,为了通用性，不污染原数组
// 这个作为公用的方法
function shuffle(arr) {
    if (!arr || !Array.isArray(arr)) {
        throw '错误，请传入正确的数组格式';
    }

    var newArr = arr.slice(0);
    for (var i = newArr.length - 1; i &gt;= 0; i--) {
        // 随机范围[0,1)
        var randomIndex = Math.floor(Math.random() * (i + 1));
        var itemAtIndex = newArr[randomIndex];
        newArr[randomIndex] = newArr[i];
        newArr[i] = itemAtIndex;
    }

    return newArr;
}

// 扑克牌的构造函数
function Poker() {
    // 第一步:定义四个花色，这里就用中文了
    var cardType = ['黑桃', '红桃', '梅花', '方块'];

    // 第二步:定义13张普通牌
    var cardValue = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

    // 第三步:定义2张特殊牌，大王与小王
    var specialCard = ['大王', '小王'];

    // 第四步:根据上述数组生成54张牌
    var allCards = [];
    for (var i = 0,
    len1 = cardType.length; i &lt; len1; i++) {
        for (var j = 0,
        len2 = cardValue.length; j &lt; len2; j++) {
            allCards.push(cardType[i] + cardValue[j]);
        }
    }
    allCards = allCards.concat(specialCard);

    this.originalPokers = allCards;
    this.pokers = this.originalPokers;
}

// 扑克牌的洗牌
Poker.prototype.shuffle = function() {
    // 洗牌-不污染原先的数组,每次用原始的扑克洗牌
    // 每次洗牌后都是一副新的牌
    this.pokers = shuffle(this.originalPokers);
};

// 扑克牌的发牌
Poker.prototype.dealPokers = function(num) {
    // 删除，会改变原来的pokers数组,已经没有了则会返回[]
    return this.pokers.splice(0, num);
};

// 测试用例
// 生成一副扑克牌
var poker = new Poker();
// 洗牌
poker.shuffle();
// 多次发牌
console.log(poker.dealPokers(1));
console.log(poker.dealPokers(3));
console.log(poker.dealPokers(10));
console.log("剩余扑克:");
console.log(poker.pokers);
</code></pre>
</div>

<h3 id="代码详解">代码详解</h3>
<p>上述代码中核心算法是洗牌算法，其余只是基于这个洗牌算法进行拓展的实际应用代码。</p>

<h2 id="洗牌算法">洗牌算法</h2>
<p>洗牌算法一般可分为两种:</p>

<ul>
  <li>原始洗牌算法</li>
  <li>现代优化方法</li>
</ul>

<p>以上代码其实是属于现代优化方法的。以下分别介绍原始算法与现代方法。</p>

<h3 id="原始洗牌算法">原始洗牌算法</h3>
<p>也称为<code class="highlighter-rouge">Fisher–Yates shuffle</code>的原始版，实现如下:</p>

<ul>
  <li><code class="highlighter-rouge">1-N</code>存储在原始列表list1中</li>
  <li>随机洗好的牌存储在新列表list2中</li>
  <li>随机生成一个数字k(1到剩下的数字(包括这个数字))</li>
  <li>从低位开始，得到第 k 个数字(这个数字还没有被取出)，取出，并存在list2中</li>
  <li>重复第三步，重新生成k，直到所有数字都被取出</li>
  <li>取出的这个列表，就是原始列表的随机排序列表，完成算法</li>
</ul>

<p>这个算法的特点是，时间复杂度为 <code class="highlighter-rouge">O(N^2)</code></p>

<h3 id="现代优化算法">现代优化算法</h3>
<p>这个优化算法去除了无用的重复计算，实现如下:</p>

<ul>
  <li><code class="highlighter-rouge">1-N</code>存储在列表list中，当前索引为index=N</li>
  <li>随机生成一个数字k(1到index(包括这个数字))</li>
  <li>交换第k为和第index位元素的值</li>
  <li>index–</li>
  <li>如果index到了最后一位(1)，则退出循环，这时候list已经被随机排序了，完成算法</li>
</ul>

<p>这个算法相比原生算法，直接将时间复杂度缩小到了<code class="highlighter-rouge">O(N)</code></p>

<h2 id="附录">附录</h2>

<h3 id="参考资料">参考资料</h3>
<p><a href="https://gaohaoyang.github.io/2016/10/16/shuffle-algorithm/">https://gaohaoyang.github.io/2016/10/16/shuffle-algorithm/</a></p>

<h3 id="原文链接">原文链接</h3>
<p><a href="https://dailc.github.io/2017/03/07/shufflePoker.html">https://dailc.github.io/2017/03/07/shufflePoker.html</a></p>

					</div>
					<!-- 上一篇与下一篇-->
					<section align="right" class="post-next-prev">
					  <span>
					    <a  href="/2017/03/04/bookReview_theThreeMusketeers.html" class="active"  >上一篇</a>
					    &nbsp;&nbsp;&nbsp;
					    <a  href="/2017/03/12/bookReview_wutheringHeighs.html" class="active"  >下一篇</a>
					  </span>
					</section>
				</div>
				<!-- 多说-->
				
<!--多说评论 -->
<div id="duoshuo-container">
<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="http://localhost:4000/2017/03/07/shufflePoker.html}" data-title="洗牌算法-扑克牌原来这么玩！" data-url="http://localhost:4000/2017/03/07/shufflePoker.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"dailc"};
(function() {
	var ds = document.createElement('script');
	ds.type = 'text/javascript';ds.async = true;
	ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	ds.charset = 'UTF-8';
	(document.getElementsByTagName('head')[0] 
	 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->
</div>

				
				
			</div>
			
			<!-- 右侧包括个人介绍，TOC菜单-->
			<div class="col-md-3">
				<!-- 右侧人物面板-->
				<div class="effect1 person-card">
					
				 	<a  class="member-image">
				 			<img src="/asserts/images/img_avatar.jpg" alt="Lichun Dai"/>
				 	</a>
				 	<div class="member-info">
				 		<p class="info-name">
				 		<a >
				 			Lichun Dai
				 		</a>
				 		</p>
				 		<p>
				 			单线程生物，无法同时专注于多件事情。做自己感兴趣的工作，目前偏爱前端。业余爱好:口琴、吉他。
				 		</p>
				 	<p class="info-foot">
				 		<a class="left-card left" href="/blog/archive.html">
				 			<em>
				 				博客
				 			</em>
				 			<strong>
				 				28
				 				
				 			</strong>
				 		</a>
				 		<a class="middle-card left" href="/demo/demo.html">
				 			<em>
				 				项目
				 			</em>
				 			<strong>
				 				2
				 			</strong>
				 		</a>
				 		<a class="right-card left" href="/blog/archiveAll.html">
				 			<em>
				 				随笔
				 			</em>
				 			<strong>
				 				58
				 			</strong>
				 		</a>
				 	</p>
				 	<p class="info-social-touch">
				 		<a target="_blank" href="https://github.com/dailc" ><img src="/asserts/images/icons/favicon_github.ico" alt="GitHub"/> </a>
						<a target="_blank" href="http://5sing.kugou.com/54188866/default.html"><img src="/asserts/images/icons/favicon_5sing.ico" alt="5sing" /> </a>	
						<a target="_blank" href="http://changba.com/u/200945262"><img src="/asserts/images/icons/favicon_changba.ico" alt="唱吧" /> </a>
						<a target="_blank" href="https://www.zhihu.com/people/dailichun"><img src="/asserts/images/icons/favicon_zhihu.ico" alt="知乎" /> </a>
						<a target="_blank" href="http://www.jianshu.com/u/c104d2a4baec"><img src="/asserts/images/icons/favicon_jianshu.ico" alt="简书" /> </a>
				 	</p>
				 	</div>
				</div>

				 <!-- TOC动态菜单-->
				  <div class="slideNavContainer">     
				</div> 				
					
			</div> 
 
		</div>
	</div>
		
<script type="text/javascript" src="/asserts/js/post.js" ></script>
<script type="text/javascript" src="/asserts/js/imageBubble.js" ></script>
<script>
	ImageBubble.init('.container img');
</script>
	
	<!-- 脚步,包括版权声明，访问次数等-->
	<footer class="footer">
	    <p class="copyright">
	    	<small>
	            <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/cn/" target="_blank" title="许可协议">©</a> 2016&nbsp;&nbsp;&nbsp;&nbsp;<a href="/about/">Lichun Dai</a>
	        </small>
	    </p>
	    <p class="more-tips">
	    	<span>Powered by Jekyll</span>&nbsp;&nbsp;&nbsp;&nbsp;
	    	<span id="busuanzi_container_site_pv">总访客<span id="busuanzi_value_site_uv" class="site-uv"></span>人</span>&nbsp;&nbsp;&nbsp;&nbsp;
	    	<span id="busuanzi_container_site_pv">总访问<span id="busuanzi_value_site_pv" class="site-pv"></span>次</span>
	    </p>  
	</footer>

<script>
//百度统计
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?cf8506e0ef223e57ff6239944e5d46a4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!--不蒜子 -->
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



</body>
</html>
